angular.module("datetime.bootstrap",["datetime.bootstrap.directives","datetime.bootstrap.services","datetime.bootstrap.templates"]),angular.module("datetime.bootstrap.directives",["ui.bootstrap"]).directive("forceDigits",function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.forceDigits,f="clearZero"in c;d.$parsers.push(function(a){var b=a.replace(/\D/g,"");return b=b.substr(b.length-e),b=_.padLeft(b,e,"0"),f&&0==Number(b)&&(b=void 0),b!=a&&(d.$setViewValue(b),d.$render()),b})}}}).directive("forcePeriod",function(){return{require:"ngModel",link:function(a,b,c,d){c.forceDigits;d.$parsers.push(function(a){var b=a.toLowerCase();return b=_.endsWith(b,"p")?"pm":_.endsWith(b,"a")?"am":_.startsWith(b,"p")?"pm":_.startsWith(b,"a")?"am":void 0,b!=a&&(d.$setViewValue(b),d.$render()),b})}}}).directive("inFocus",["$log","$timeout",function(a,b){return{scope:{inFocus:"="},link:function(a,c,d){a.blurPromise,a.prevent=function(a){a.stopPropagation(),a.preventDefault()},a.focus=function(b){a.prevent(b),a.$apply(function(){a.inFocus=!0})},a.blur=function(c){a.prevent(c),a.blurPromise&&b.cancel(a.blurPromise),a.blurPromise=b(function(){a.$apply(function(){a.inFocus=!1})},200)},c.on("click",a.prevent),c.on("focus",a.focus),c.on("blur",a.blur)}}}]).directive("dateInput",["$log","$timeout","DateData",function(a,b,c){return{restrict:"E",scope:{date:"=",config:"=?"},templateUrl:"datetime.bootstrap.date.tmpl.html",link:function(a,d,e){function f(){null!=a.units.month&&(Number(a.units.month)<1&&(a.units.month="01"),Number(a.units.month)>12&&(a.units.month="12")),null!=a.units.day&&(Number(a.units.day)<1&&a.units.day>1,a.units.day=c.truncateDayIfNeeded(a.units.day,a.units.month,a.units.year))}function g(){var b=[null,null,null];return a.units.year&&(b[0]=Number(a.units.year)),a.units.month&&(b[1]=Number(a.units.month)),a.units.day&&(b[2]=Number(a.units.day)),b}function h(){var b=g();return a.date&&(a.date[0]||a.date[1]||a.date[2])?a.date[0]!=b[0]?!0:a.date[1]!=b[1]?!0:a.date[2]!=b[2]?!0:!1:b[0]&&b[1]&&b[2]?!0:!1}a.units={},a.focii={},a.drops={day:!1,month:!1,year:!1,date:!1},a.$watch("config",function(){a.data={},a.data.dates=c.getDates(a.config),a.data.dates||(a.data.years=c.getYears(a.config),a.data.months=c.getMonths(),a.data.days=c.getDays(a.units.month,a.units.year))},!0),a.$watch("date",function(){if(h()){if(!a.date)return void(a.units={});a.units.day=_.padLeft(a.date[2],2,"0"),a.units.month=_.padLeft(a.date[1],2,"0"),a.units.year=_.padLeft(a.date[0],4,"0")}},!0),a.$watch("units",function(){if(a.data.dates||(a.data.days=c.getDays(a.units.month,a.units.year)),h()){if(a.units.day&&a.units.month&&a.units.year){var d=g();moment([d[0],d[1]-1,d[2]]).isValid()&&(a.date=d)}else a.date=[null,null,null];a.tidyPromise&&b.cancel(a.tidyPromise),a.tidyPromise=b(f,1e3)}},!0),a.$watch("focii",function(){a.drops.day=a.focii.day&&null!=a.data.days,a.drops.month=a.focii.month&&null!=a.data.months,a.drops.year=a.focii.year&&null!=a.data.years,a.drops.date=(a.focii.day||a.focii.month||a.focii.year)&&null!=a.data.dates},!0),a.setDate=function(b){var c=moment(b);a.units.day=_.padLeft(c.date(),2,"0"),a.units.month=_.padLeft(c.month(),2,"0"),a.units.year=_.padLeft(c.year(),4,"0")}}}}]).directive("timeInput",["$log","$timeout","TimeData",function(a,b,c){var d={showMinutes:!0,showSeconds:!1,minuteAccuracy:15,secondAccuracy:15};return{restrict:"E",scope:{time:"=",config:"=?"},templateUrl:"datetime.bootstrap.time.tmpl.html",link:function(a,e,f){function g(){if(null!=a.units.hour){var b=null==a.units.hour?null:Number(a.units.hour);b>24&&(b=24),b>12&&(b-=12,a.units.period="pm"),a.units.hour=b}a.units.minute&&Number(a.units.minute)>59&&(a.units.minute=59),a.units.second&&Number(a.units.second)>59&&(a.units.second=59)}function h(){var b=c.toArray(a.units);return a.time&&(a.time[0]||a.time[1]||a.time[2])?a.time[0]!=b[0]?!0:a.time[1]!=b[1]?!0:a.time[2]!=b[2]?!0:!1:b[0]?!0:!1}a.cfg=_.clone(d),a.units={period:"am"},a.focii={},a.drops={hour:!1,minute:!1,period:!1},a.$watch("config",function(){a.cfg={},a.config?(a.cfg=_.clone(a.config),a.cfg.minuteAccuracy<1&&(a.cfg.minuteAccuracy=void 0),a.cfg.secondAccuracy<1&&(a.cfg.secondAccuracy=void 0),_.each(d,function(b,c){(null===a.cfg[c]||void 0===a.cfg[c])&&(a.cfg[c]=b)})):a.cfg=_.clone(d),a.data={},a.data.hours=c.getHours(),a.data.minutes=c.getMinutes(a.cfg),a.data.seconds=c.getSeconds(a.cfg),a.data.periods=c.getPeriods()},!0),a.$watch("time",function(){if(h()){if(!a.time)return void(a.units={period:"am"});null==a.time[0]?(a.units.hour=void 0,a.units.period="am"):(a.units.hour=a.time[0]<=12?a.time[0]:a.time[0]-12,a.units.period=a.time[0]<12||a.time[0]>23?"am":"pm"),null==a.time[1]?a.units.minute=void 0:a.units.minute=_.padLeft(a.time[1],2,"0"),null==a.time[2]?a.units.minute=void 0:a.units.second=_.padLeft(a.time[2],2,"0")}},!0),a.$watch("units",function(){h()&&(a.time=c.toArray(a.units),a.tidyPromise&&b.cancel(a.tidyPromise),a.tidyPromise=b(g,1e3))},!0)}}}]),angular.module("datetime.bootstrap.services",[]).service("DateData",function(){function a(a,b){return(!a||1>a||a>12)&&(a=1),(!b||1e3>b)&&(b=moment().year()),moment(b+" "+a+" 01","YYYY MM DD").endOf("month").date()}var b=/^(\d+) ((day|week|month|year)s?)( ago)?$/i;this.parseWithin=function(a){if(a){var c=b.exec(a);if(c){var d={},e=c[1],f=c[2],g=c[4];return g?(d.direction="past",d.end=moment(),d.start=moment().subtract(e,f)):(d.direction="future",d.start=moment(),d.end=moment().add(e,f)),d}}},this.getYears=function(a){if(a){var b=this.parseWithin(a.within);if(b){var c=[],d=b.start.year(),e=b.end.year();switch(b.direction){case"past":for(var f=e;f>=d;f--)c.push({value:f,label:f});break;case"future":for(var f=d;e>=f;f++)c.push({value:f,label:f})}return c}}},this.getMonths=function(){return this.months?this.months:(this.months=[],_.each(moment.months(),function(a,b){var c=_.padLeft(b+1,2,"0");this.push({value:c,label:a})},this.months),this.months)},this.getDays=function(b,c){for(var d=a(b,c),e=[],f=1;d>=f;f++){var g=_.padLeft(f,2,"0");e.push({value:g,label:g})}return e},this.getDates=function(a){if(a){var b=this.parseWithin(a.within);if(b){var c=Math.abs(b.end.diff(b.start,"days"));if(!(c>32)){var d=[];switch(b.direction){case"past":for(var e=moment(),f=0;c>f;f++)d.push(0==f?{value:e.format("YYYY-MM-DD"),label:"Today"}:1==f?{value:e.format("YYYY-MM-DD"),label:"Yesterday"}:{value:e.format("YYYY-MM-DD"),label:e.format("MMM Do (ddd)")}),e.subtract(1,"days");break;case"future":for(var e=moment(),f=0;c>f;f++)d.push(0==f?{value:e.format("YYYY-MM-DD"),label:"Today"}:1==f?{value:e.format("YYYY-MM-DD"),label:"Tomorrow"}:{value:e.format("YYYY-MM-DD"),label:e.format("MMM Do (ddd)")}),e.add(1,"days")}return d}}}},this.truncateDayIfNeeded=function(b,c,d){var e=a(c,d);return b>e?e:b}}).service("TimeData",function(){this.getHours=function(){if(this.hours)return this.hours;this.hours=[];for(var a=1;12>=a;a++)this.hours.push({value:a,label:a});return this.hours},this.getMinutes=function(a){for(var b=[],c=0;60>c;)b.push({value:_.padLeft(c,2,"0"),label:_.padLeft(c,2,"0")}),c+=a.minuteAccuracy;return b},this.getSeconds=function(a){for(var b=[],c=0;60>c;)b.push({value:_.padLeft(c,2,"0"),label:_.padLeft(c,2,"0")}),c+=a.secondAccuracy;return b},this.getPeriods=function(){return this.periods?this.periods:(this.periods=[{value:"am",label:"am"},{value:"pm",label:"pm"}],this.periods)},this.toArray=function(a){var b=null==a.hour?null:Number(a.hour),c=null==a.minute?null:Number(a.minute),d=null==a.second?null:Number(a.second);return null==b?[null,null,null]:(null==c&&(c=0),null==d&&(d=0),b>12||1>b?[null,null,null]:c>59?[null,null,null]:d>59?[null,null,null]:("pm"==a.period&&(b+=12),[b,c,d]))}}),angular.module("datetime.bootstrap.templates",["datetime.bootstrap.date.tmpl.html","datetime.bootstrap.time.tmpl.html"]),angular.module("datetime.bootstrap.date.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("datetime.bootstrap.date.tmpl.html",'<div dropdown class=dropdown is-open=drops.date style="display: inline-block" auto-close=disabled><div class=form-control><div dropdown class=dropdown is-open=drops.day style="display: inline-block" auto-close=disabled><input class=internal-form-control ng-model=units.day placeholder=dd force-digits=2 clear-zero in-focus=focii.day style="width:2em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="d in data.days"><a role=menuitem ng-click="units.day = d.value">{{d.label}}</a></li></ul></div>&nbsp;/&nbsp;<div dropdown class=dropdown is-open=drops.month auto-close=disabled style="display: inline-block"><input class=internal-form-control ng-model=units.month placeholder=mm force-digits=2 clear-zero in-focus=focii.month style="width:2em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="m in data.months"><a role=menuitem ng-click="units.month = m.value" stop-propagation>{{m.label}}</a></li></ul></div>&nbsp;/&nbsp;<div dropdown class=dropdown is-open=drops.year auto-close=disabled style="display: inline-block"><input class=internal-form-control ng-model=units.year placeholder=yyyy force-digits=4 clear-zero in-focus=focii.year style="width:4em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="y in data.years"><a role=menuitem ng-click="units.year = y.value">{{y.label}}</a></li></ul></div></div><ul class=dropdown-menu role=menu><li ng-repeat="date in data.dates"><a role=menuitem tabindex=-1 ng-click=setDate(date.value)>{{date.label}}</a></li></ul></div>')}]),angular.module("datetime.bootstrap.time.tmpl.html",[]).run(["$templateCache",function(a){"use strict";a.put("datetime.bootstrap.time.tmpl.html",'<div class=form-control><div dropdown class=dropdown is-open=focii.hour style="display: inline-block" auto-close=disabled><input class=internal-form-control ng-model=units.hour placeholder=hh force-digits=2 clear-zero in-focus=focii.hour style="width:2em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="h in data.hours"><a role=menuitem ng-click="units.hour = h.value">{{h.label}}</a></li></ul></div><div ng-if=cfg.showMinutes style=display:inline-block>&nbsp;:&nbsp;<div dropdown class=dropdown is-open=focii.minute auto-close=disabled style="display: inline-block"><input class=internal-form-control ng-model=units.minute placeholder=mm force-digits=2 in-focus=focii.minute style="width:2em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="m in data.minutes"><a role=menuitem ng-click="units.minute = m.value">{{m.label}}</a></li></ul></div></div><div ng-if="cfg.showMinutes && cfg.showSeconds" style=display:inline-block>&nbsp;:&nbsp;<div dropdown class=dropdown is-open=focii.second auto-close=disabled style="display: inline-block"><input class=internal-form-control ng-model=units.second placeholder=ss force-digits=2 in-focus=focii.second style="width:2em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="s in data.seconds"><a role=menuitem ng-click="units.second = s.value">{{s.label}}</a></li></ul></div></div>&nbsp;&nbsp;<div dropdown class=dropdown is-open=focii.period auto-close=disabled style="display: inline-block"><input class=internal-form-control ng-model=units.period force-period in-focus=focii.period style="width:2em ; text-align:center"><ul class=dropdown-menu role=menu style="max-height: 300px; overflow-y: auto"><li ng-repeat="p in data.periods"><a role=menuitem ng-click="units.period = p.value">{{p.label}}</a></li></ul></div></div>')}]);